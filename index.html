<!doctype html>
<html>

<head>
	<title>GPS Base Station</title>
	<style>
		#map {
			height: 500px;
			width: 700px;
		}
	</style>
</head>

<body>
	<div>
		GPS Base Station
		<hr />
		Latitude: <input type="text" id="lat" value="">
		<br />
		Longitude: <input type="text" id="lon" value="">
	</div>

	<br><br>

	<div>
		Map
		<hr />
		<div id="map"></div>
	</div>



	<script src="/socket.io/socket.io.js"></script>
	<script src="https://code.jquery.com/jquery-1.11.1.js"></script>

	<script>

		//initialize google map vars
		var map = null
		var marker = null

		$(() => {

			//open socket for communication with backend
			var socket = io()

			socket.on('sensor data', msg => {
				//console.log(msg);

				if (msg.gps && msg.gps.lat && msg.gps.lon) {

					$('#lat').val(msg.gps.lat)
					$('#lon').val(msg.gps.lon)

					marker && marker.setPosition({
						lat: msg.gps.lat,
						lng: msg.gps.lon
					})
					//marker.setMap(map);
				}
			})
		})


		//initialize google map
		initMap = () => {

			//create  a map
			map = new google.maps.Map(document.getElementById('map'), {
				center: { lat: 40.602826666666665, lng: -80.073335 },
				zoom: 20
			})

			//create a marker
			marker = new google.maps.Marker({
				map: map,
				title: 'GPS Mower!'
			})

			//replace default icon for a marker
			marker.setIcon(({
				path: google.maps.SymbolPath.BACKWARD_CLOSED_ARROW,
				scale: 6,
				rotation: 0
			}))

		}
	</script>
	<script
		src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBvCDEAYYi6RI-_8C6kDrBfIyHans6KgYA&callback=initMap&libraries=geometry"
		async defer></script>

</body>

</html>